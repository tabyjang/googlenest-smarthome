---
phase: 02-error-handling
type: execute
---

<objective>
React Error Boundary 구현 및 사용자 친화적 에러 UI 생성

목적: 예상치 못한 컴포넌트 오류를 감지하고 앱 전체가 크래시되지 않도록 보호
결과물: ErrorBoundary 컴포넌트, ErrorFallback UI, App.tsx 적용 완료
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-testing-infrastructure/01-02-SUMMARY.md
@App.tsx
@.planning/codebase/ARCHITECTURE.md
@.planning/codebase/CONVENTIONS.md

**테스트 인프라 준비 완료:**
- Vitest + React Testing Library 설정됨 (Phase 1)
- 테스트 패턴 확립: MemoryRouter, 접근성 중심 쿼리

**현재 에러 처리 상태:**
- Suspense는 있지만 Error Boundary 없음
- 컴포넌트 오류 발생 시 앱 전체 크래시
- 사용자에게 명확한 에러 피드백 없음

**프로젝트 컨벤션:**
- React.FC 함수형 컴포넌트
- PascalCase.tsx 파일명
- components/ 디렉토리 구조
- Tailwind CSS 디자인 시스템 (cream, charcoal, gold 컬러)
</context>

<tasks>

<task type="auto">
  <name>Task 1: ErrorBoundary 컴포넌트 생성</name>
  <files>components/ErrorBoundary.tsx</files>
  <action>React class 컴포넌트로 ErrorBoundary 생성:

1. React.Component를 상속받는 ErrorBoundary 클래스 생성
2. state에 { hasError: boolean, error: Error | null } 정의
3. static getDerivedStateFromError(error) 메서드 구현 - hasError를 true로 설정
4. componentDidCatch(error, errorInfo) 메서드 구현 - console.error로 로깅 (프로덕션에서는 Sentry 등으로 전송 가능)
5. render() 메서드:
   - hasError가 true면 this.props.fallback 렌더링
   - false면 this.props.children 렌더링
6. TypeScript 인터페이스 정의:
   - Props: { children: React.ReactNode, fallback: React.ReactNode }
   - State: { hasError: boolean, error: Error | null }

**주의사항:**
- Error Boundary는 반드시 클래스 컴포넌트여야 함 (함수형 컴포넌트 불가)
- 이벤트 핸들러 내 에러는 감지 못함 (try-catch 필요)
- 비동기 코드 에러도 감지 못함 (별도 처리 필요)
</action>
  <verify>TypeScript 컴파일 오류 없음, npm run build 성공</verify>
  <done>ErrorBoundary.tsx 파일 생성됨, 타입 정의 완료, export default 존재</done>
</task>

<task type="auto">
  <name>Task 2: ErrorFallback UI 컴포넌트 생성</name>
  <files>components/ErrorFallback.tsx</files>
  <action>사용자 친화적인 에러 폴백 UI 컴포넌트 생성:

1. React.FC<{ error?: Error, resetError?: () => void }> 타입으로 생성
2. UI 구조:
   - 중앙 정렬 레이아웃 (min-h-screen flex items-center justify-center)
   - 배경: bg-cream-100
   - 카드 형태 컨테이너 (max-w-lg mx-auto p-8 bg-white rounded-3xl shadow-luxury)
   - 아이콘: 에러 표시 (⚠️ 이모지 또는 SVG)
   - 제목: "문제가 발생했습니다" (text-2xl font-display text-charcoal-700)
   - 설명: "일시적인 오류가 발생했습니다. 페이지를 새로고침하거나 잠시 후 다시 시도해주세요." (text-charcoal-400)
   - 버튼 2개:
     a. "페이지 새로고침" 버튼 - window.location.reload() 실행 (주요 액션, 어두운 배경)
     b. "홈으로 돌아가기" 버튼 - window.location.href = '/' (보조 액션, 밝은 배경)

3. 디자인:
   - 프로젝트 컬러 시스템 사용 (cream, charcoal, gold)
   - 버튼 스타일: rounded-full, px-6 py-3, shadow-luxury
   - 일관된 간격 (gap-4, mb-6 등)

**개발 환경에서만:**
- error prop이 있으면 error.message를 작은 회색 텍스트로 표시 (디버깅용)

**주의사항:**
- 너무 기술적인 용어 사용하지 말 것
- 사용자에게 명확한 액션 제공
- 프로덕션에서는 에러 상세 내용 숨기기
</action>
  <verify>ErrorFallback 컴포넌트 렌더링 확인, 버튼 클릭 동작 확인</verify>
  <done>ErrorFallback.tsx 생성, UI 구현 완료, 두 개의 액션 버튼 작동</done>
</task>

<task type="auto">
  <name>Task 3: App.tsx에 ErrorBoundary 적용 및 테스트</name>
  <files>App.tsx, components/ErrorBoundary.test.tsx</files>
  <action>1. App.tsx 수정:
   - ErrorBoundary와 ErrorFallback import
   - 전체 앱을 ErrorBoundary로 감싸기:
     ```tsx
     <ErrorBoundary fallback={<ErrorFallback />}>
       <Suspense fallback={<PageLoader />}>
         <Routes>...</Routes>
       </Suspense>
     </ErrorBoundary>
     ```
   - 순서: ErrorBoundary 가장 바깥, Suspense 안쪽

2. ErrorBoundary 테스트 작성 (components/ErrorBoundary.test.tsx):
   - 테스트 1: 에러 발생하지 않으면 children 정상 렌더링
   - 테스트 2: 에러 발생 시 fallback UI 렌더링
   - 테스트용 컴포넌트 생성:
     ```tsx
     const ThrowError = () => {
       throw new Error('Test error');
     };
     ```
   - React Testing Library로 에러 감지 확인
   - console.error mock 처리 (테스트 중 에러 로그 방지)

**주의사항:**
- Suspense는 로딩 상태, ErrorBoundary는 에러 상태 담당
- ErrorBoundary가 Suspense보다 바깥에 있어야 Suspense 에러도 감지 가능
</action>
  <verify>npm test 통과, npm run build 성공</verify>
  <done>App.tsx에 ErrorBoundary 적용, ErrorBoundary.test.tsx 2개 테스트 통과</done>
</task>

</tasks>

<verification>
완료 전 확인사항:
- [ ] npm test 모든 테스트 통과
- [ ] npm run build 성공
- [ ] TypeScript 오류 없음
- [ ] ErrorBoundary가 에러 감지 및 폴백 표시
- [ ] 정상 동작 시 children 렌더링
</verification>

<success_criteria>

- ErrorBoundary.tsx 생성 완료 (class component)
- ErrorFallback.tsx 생성 완료 (사용자 친화적 UI)
- App.tsx에 ErrorBoundary 적용
- ErrorBoundary 테스트 2개 통과
- 빌드 및 타입 체크 정상
- 앱 크래시 방지 메커니즘 작동
  </success_criteria>

<output>
완료 후 `.planning/phases/02-error-handling/02-01-SUMMARY.md` 생성:

# Phase 2 Plan 1: Error Boundary 및 에러 UI 요약

**React Error Boundary로 앱 안정성 확보**

## 달성 사항

- ErrorBoundary 컴포넌트 구현 (에러 감지 및 폴백)
- ErrorFallback UI 컴포넌트 생성 (사용자 친화적 메시지)
- App.tsx에 ErrorBoundary 적용 (앱 전체 보호)
- ErrorBoundary 테스트 추가 (정상/에러 케이스)

## 생성/수정 파일

- `components/ErrorBoundary.tsx` - 생성
- `components/ErrorFallback.tsx` - 생성
- `App.tsx` - ErrorBoundary 적용
- `components/ErrorBoundary.test.tsx` - 생성

## 결정 사항

- Error Boundary 위치: 앱 최상위 (Suspense 바깥쪽)
- 폴백 UI: 2개 액션 버튼 (새로고침, 홈으로)
- 에러 로깅: console.error (추후 Sentry 등 연동 가능)

## 발생한 이슈

[이슈가 있었다면 기록, 없으면 "없음"]

## 다음 단계 준비

Plan 02-02로 진행:
- 로딩 상태 컴포넌트 통합
- API 에러 처리 개선
- 사용자 피드백 UI 추가
</output>
